<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Eike Kettner">
<meta name="description" content="Simple Document Organizer">
<meta name="image" property="og:image" content="/img/poster.png">
<meta name="title" property="og:title" content="Docspell â€“ Simple Document Organizer">
<meta name="og:image" content="/img/poster.png">
<meta name="og:title" content="Docspell â€“ Simple Document Organizer">
<meta name="og:site_name" content="Component Interaction - Docspell">
<meta name="og:url" content="">
<meta name="og:type" content="website">
<meta name="og:description" content="Simple Document Organizer">
<meta name="twitter:title" content="Docspell">
<meta name="twitter:image" content="/img/poster.png">
<meta name="twitter:description" content="Simple Document Organizer">
<meta name="twitter:card" content="summary_large_image">

<link rel="shortcut icon" href="/favicon-mc.ico" type="image/x-icon">
<link rel="icon" href="/favicon-mc.ico" type="image/x-icon">

        <title>Component Interaction â€“ Docspell Documentation</title>
        <link rel="stylesheet" href="/styles.css">
    </head>
    <body>
        <section class="hero is-info is-small">
            <div class="hero-head">
                <nav class="navbar">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <span class="icon">
                <img src="/icons/logo-only-36.svg">
            </span>
            <span>
                Docspell
            </span>
        </a>
    </div>
    <div class="navbar-start">
        <a target="_blank"
           href="https://github.com/eikek/docspell"
           class="navbar-item">
            <span class="icon">
                <img src="/icons/github-40.svg">
            </span>
            <span>
                Github
            </span>
        </a>
    </div>
</nav>

            </div>
            <div class="hero-body">
                <h1 class="title">
                    Component Interaction
                </h1>
                <h2 class="subtitle">
                    Docspell Documentation
                </h2>
            </div>
        </section>
        <nav class="breadcrumb has-succeeds-separator" aria-label="breadcrumbs">
            <ul>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;"></a>
                </li>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;">Overview</a>
                </li>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;">Development</a>
                </li>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;">ADRs</a>
                </li>
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;0002-component-interaction&#x2F;">Component Interaction</a>
                </li>
            </ul>
        </nav>

        <section class="section pt-2">
            <div class="columns is-desktop">
                <div class="column is-3">
                    <div class="menu">
                        <ul class="menu-list">
                            
                            

                            <p class="menu-label">
                                ADRs
                            </p>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0000-use-markdown-architectural-decision-records/"
                                   >
                                    Use Markdown Architectural Decision Records
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0001-components/"
                                   >
                                    Components
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0002-component-interaction/"
                                   class="is-active">
                                    Component Interaction
                                </a>
                                
                                <ul class="menu-list">
                                    
                                    <li>
                                        <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;0002-component-interaction&#x2F;#context-and-problem-statement">
                                            Context and Problem Statement
                                        </a>
                                        <ul>
                                            
                                        </ul>
                                    </li>
                                    
                                    <li>
                                        <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;0002-component-interaction&#x2F;#considered-options">
                                            Considered Options
                                        </a>
                                        <ul>
                                            
                                        </ul>
                                    </li>
                                    
                                    <li>
                                        <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;0002-component-interaction&#x2F;#decision-outcome">
                                            Decision Outcome
                                        </a>
                                        <ul>
                                            
                                            <li>
                                                <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;0002-component-interaction&#x2F;#positive-consequences">
                                                    Positive Consequences
                                                </a>
                                            </li>
                                            
                                            <li>
                                                <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;dev&#x2F;adr&#x2F;0002-component-interaction&#x2F;#negative-consequences">
                                                    Negative Consequences
                                                </a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                    
                                </ul>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0003-encryption/"
                                   >
                                    Encryption
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0004-iso8601vsepoch/"
                                   >
                                    Iso8601 Vs Millis As Date-Time Transfer
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0005-job-executor/"
                                   >
                                    Joex - Job Executor
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0006-more-file-types/"
                                   >
                                    More File Types
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0007-convert-html-files/"
                                   >
                                    Convert Html Files
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0008-convert-plain-text/"
                                   >
                                    Convert Text Files
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0009-convert-office-docs/"
                                   >
                                    Convert Office Documents
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0010-convert-image-files/"
                                   >
                                    Convert Image Files
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0011-extract-text/"
                                   >
                                    Extract Text From Files
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0012-periodic-tasks/"
                                   >
                                    Periodic Tasks
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0013-archive-files/"
                                   >
                                    Archive Files
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0014-fulltext-search-engine/"
                                   >
                                    Fulltext Search Engine
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/dev/adr/0015-convert-pdf-files/"
                                   >
                                    Convert Pdf Files
                                </a>
                                
                            </li>
                            
                        </ul>
                    </div>
                </div>

                <div class="column is-9">
                    <div class="container">
                        <div class="content doc">
                            <h1 id="context-and-problem-statement">Context and Problem Statement<a class="zola-anchor" href="#context-and-problem-statement" aria-label="Anchor link for: context-and-problem-statement">ðŸ”—</a></h1>
<p>There are multiple web applications with their rest servers and there
are multiple document processors. These processes must communicate:</p>
<ul>
<li>once a new job is added to the queue the rest server must somehow
notify processors to wake up</li>
<li>once a processor takes a job, it must propagate the progress and
outcome to all rest servers only that the rest server can notify the
user that is currently logged in. Since it's not known which
rest-server the user is using right now, all must be notified.</li>
</ul>
<h1 id="considered-options">Considered Options<a class="zola-anchor" href="#considered-options" aria-label="Anchor link for: considered-options">ðŸ”—</a></h1>
<ol>
<li>JMS (ActiveMQ or similiar): Message Broker as another active
component</li>
<li>Akka: using a cluster</li>
<li>DB: Register with &quot;call back urls&quot;</li>
</ol>
<h1 id="decision-outcome">Decision Outcome<a class="zola-anchor" href="#decision-outcome" aria-label="Anchor link for: decision-outcome">ðŸ”—</a></h1>
<p>Choosing option 3: DB as central synchronisation point.</p>
<p>The reason is that this is the simplest solution and doesn't require
external libraries or more processes. The other options seem too big
of a weapon for the task at hand. They are both large components
itself and require more knowledge to use them efficiently.</p>
<p>It works roughly like this:</p>
<ul>
<li>rest servers and processors register at the database on startup each
with a unique call-back url</li>
<li>and deregister on shutdown</li>
<li>each component has db access</li>
<li>rest servers can list all processors and vice versa</li>
</ul>
<h2 id="positive-consequences">Positive Consequences<a class="zola-anchor" href="#positive-consequences" aria-label="Anchor link for: positive-consequences">ðŸ”—</a></h2>
<ul>
<li>complexity of the whole application is not touched</li>
<li>since a lot of data must be transferred to the document processors,
this is solved by simply accessing the db. So the protocol for data
exchange is set. There is no need for other protocols that handle
large data (http chunking etc)</li>
<li>uses the already exsting db as synchronisation point</li>
<li>no additional knowledge required</li>
<li>simple to understand and so not hard to debug</li>
</ul>
<h2 id="negative-consequences">Negative Consequences<a class="zola-anchor" href="#negative-consequences" aria-label="Anchor link for: negative-consequences">ðŸ”—</a></h2>
<ul>
<li>all components must have db access. this also is a security con,
because if one of those processes is hacked, db access is
possible. and it simply is another dependency that is not really
required for the joex component</li>
<li>the joex component cannot be in an untrusted environment (untrusted
from the db's point of view). For example, it is not possible to
create &quot;personal joex&quot; that only receive your own jobsâ€¦</li>
<li>in order to know if a component is really active, one must run a
ping against the call-back url</li>
</ul>

                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="footer">
    <div class="container">
        <div class="content has-text-centered">
            <span>
                Docspell, 0.11.1
            </span>
            <span class="ml-1 mr-1">â€¢</span>
            <a href="https://spdx.org/licenses/GPL-3.0-or-later.html" target="_blank">GPLv3+</a>
            <span class="ml-1 mr-1">â€¢</span>
            <a href="https://github.com/eikek/docspell" target="_blank">
                Source Code
            </a>
            <span class="ml-1 mr-1">â€¢</span>
            <span>
                Â© 2020
                <a href="https://github.com/eikek" target="_blank">
                    @eikek
                </a>
            </span>
        </div>
    </div>
    
</footer>

    </body>
    <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
    <script>
     (function(f, a, t, h, o, m){
         a[h]=a[h]||function(){
             (a[h].q=a[h].q||[]).push(arguments)
         };
         o=f.createElement('script'),
         m=f.getElementsByTagName('script')[0];
         o.async=1; o.src=t; o.id='fathom-script';
         m.parentNode.insertBefore(o,m)
     })(document, window, '//webstats.daheim.site/tracker.js', 'fathom');
     fathom('set', 'siteId', 'OGJDF');
     fathom('trackPageview');
    </script>
    <!-- / Fathom -->
</html>
